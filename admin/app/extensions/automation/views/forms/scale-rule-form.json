{
  "id": "scale-rule-form",
  "title": "i18n:automation.scale_rules.form.title",
  "description": "i18n:automation.scale_rules.form.description",
  "fields": [
    {
      "name": "name",
      "label": "i18n:automation.scale_rules.field.name",
      "type": "text",
      "required": true,
      "placeholder": "i18n:automation.scale_rules.field.name_placeholder",
      "validation": "required|min:3|max:200"
    },
    {
      "name": "level",
      "label": "i18n:automation.scale_rules.field.level",
      "type": "select",
      "required": true,
      "options": [
        {"value": "", "label": "i18n:core.form.select.placeholder"},
        {"value": "campaign", "label": "i18n:automation.scale_rules.level.campaign"},
        {"value": "adset", "label": "i18n:automation.scale_rules.level.adset"},
        {"value": "ad", "label": "i18n:automation.scale_rules.level.ad"}
      ],
      "validation": "required",
      "help": "i18n:automation.scale_rules.field.level_help"
    },
    {
      "type": "html",
      "content": "<div style='background: #f3f4f6; padding: 1rem; border-radius: 6px; margin: 1rem 0; border-left: 4px solid #3b82f6;'><strong>üìã Acciones</strong><p style='margin: 0.5rem 0 0; font-size: 0.9rem;'>Define qu√© acciones se ejecutar√°n cuando se cumplan las condiciones. Puedes agregar m√∫ltiples acciones que se ejecutar√°n en secuencia.</p></div>"
    },
    {
      "name": "actions",
      "label": "i18n:automation.scale_rules.field.actions",
      "type": "repeatable",
      "addText": "‚ûï i18n:automation.scale_rules.actions.add",
      "removeText": "üóëÔ∏è",
      "hasHeader": true,
      "accordion": true,
      "headerTitle": "i18n:automation.scale_rules.actions.header {index}",
      "fields": [
        {
          "name": "action_type",
          "label": "i18n:automation.scale_rules.field.action_type",
          "type": "select",
          "required": true,
          "options": [
            {"value": "", "label": "i18n:core.form.select.placeholder"},
            {"value": "pause", "label": "i18n:automation.scale_rules.action_type.pause"},
            {"value": "increase_budget", "label": "i18n:automation.scale_rules.action_type.increase_budget"},
            {"value": "decrease_budget", "label": "i18n:automation.scale_rules.action_type.decrease_budget"}
          ],
          "validation": "required"
        },
        {
          "type": "group",
          "columns": 4,
          "gap": "normal",
          "condition": [
            {"field": "action_type", "operator": "any", "value": "increase_budget,decrease_budget"}
          ],
          "conditionContext": "repeatable",
          "fields": [
            {
              "name": "change_by",
              "label": "i18n:automation.scale_rules.field.change_by",
              "type": "number",
              "required": true,
              "placeholder": "20",
              "min": 0,
              "step": 1,
              "validation": "required|min:0"
            },
            {
              "name": "change_type",
              "label": "i18n:automation.scale_rules.field.change_type",
              "type": "select",
              "required": true,
              "options": [
                {"value": "percent", "label": "%"},
                {"value": "fixed", "label": "$"}
              ],
              "validation": "required"
            },
            {
              "name": "until_limit",
              "label": "i18n:automation.scale_rules.field.until_limit",
              "type": "number",
              "required": true,
              "placeholder": "500",
              "min": 0,
              "step": 0.01,
              "validation": "required|min:0",
              "help": "i18n:automation.scale_rules.field.until_limit_help"
            },
            {
              "name": "until_currency",
              "label": "i18n:automation.scale_rules.field.currency",
              "type": "select",
              "required": true,
              "options": [
                {"value": "USD", "label": "$"}
              ],
              "defaultValue": "USD"
            }
          ]
        },
        {
          "type": "group",
          "columns": 2,
          "gap": "normal",
          "condition": [
            {"field": "action_type", "operator": "any", "value": "increase_budget,decrease_budget"}
          ],
          "conditionContext": "repeatable",
          "fields": [
            {
              "name": "time_period",
              "label": "i18n:automation.scale_rules.field.time_period",
              "type": "select",
              "required": true,
              "options": [
                {"value": "everytime", "label": "i18n:automation.scale_rules.time_period.everytime"},
                {"value": "once", "label": "i18n:automation.scale_rules.time_period.once"},
                {"value": "daily", "label": "i18n:automation.scale_rules.time_period.daily"}
              ],
              "validation": "required",
              "help": "i18n:automation.scale_rules.field.time_period_help"
            },
            {
              "name": "budget_type",
              "label": "i18n:automation.scale_rules.field.budget_type",
              "type": "select",
              "required": true,
              "options": [
                {"value": "daily", "label": "i18n:automation.scale_rules.budget_type.daily"},
                {"value": "lifetime", "label": "i18n:automation.scale_rules.budget_type.lifetime"}
              ],
              "validation": "required",
              "condition": [
                {"field": "level", "operator": "any", "value": "campaign,adset"}
              ],
              "conditionContext": "form"
            }
          ]
        },
        {
          "type": "html",
          "content": "<div style='background: #dbeafe; padding: 0.75rem; border-radius: 4px; margin: 1rem 0; border-left: 3px solid #3b82f6; font-size: 0.85rem;'><strong>‚ÑπÔ∏è Nota sobre acciones de presupuesto</strong><br>Las acciones de aumentar/disminuir presupuesto NO se ejecutan en campa√±as CBO (Campaign Budget Optimization).</div>",
          "condition": [
            {"field": "action_type", "operator": "any", "value": "increase_budget,decrease_budget"},
            {"field": "level", "operator": "==", "value": "adset"}
          ],
          "conditionContext": "repeatable"
        }
      ]
    },
    {
      "type": "html",
      "content": "<div style='background: #f0fdf4; padding: 1rem; border-radius: 6px; margin: 2rem 0 1rem; border-left: 4px solid #10b981;'><strong>üéØ Condiciones</strong><p style='margin: 0.5rem 0 0; font-size: 0.9rem;'>Define las condiciones que deben cumplirse para que se ejecuten las acciones. Las condiciones se eval√∫an seg√∫n la l√≥gica seleccionada.</p></div>"
    },
    {
      "type": "html",
      "content": "<div class='view-toolbar' style='display: flex; justify-content: flex-end; margin-bottom: 1rem;'><select id='conditions_logic' name='conditions_logic' class='form-control' style='width: auto;'><option value='and_or_and'>(AND) or (AND)</option><option value='or_and_or'>(OR) and (OR)</option></select></div>"
    },
    {
      "name": "condition_groups",
      "label": "i18n:automation.scale_rules.field.condition_groups",
      "type": "repeatable",
      "addText": "‚ûï i18n:automation.scale_rules.conditions.add_group",
      "removeText": "üóëÔ∏è",
      "hasHeader": true,
      "accordion": true,
      "headerTitle": "i18n:automation.scale_rules.conditions.group_header {index}",
      "fields": [
        {
          "name": "conditions",
          "label": "i18n:automation.scale_rules.field.conditions",
          "type": "repeatable",
          "addText": "‚ûï i18n:automation.scale_rules.conditions.add",
          "removeText": "‚ùå",
          "fields": [
            {
              "type": "group",
              "columns": 5,
              "gap": "small",
              "fields": [
                {
                  "name": "metric",
                  "label": "i18n:automation.scale_rules.field.metric",
                  "type": "select",
                  "required": true,
                  "options": [
                    {"value": "", "label": "i18n:core.form.select.placeholder"},
                    {"value": "roas", "label": "ROAS"},
                    {"value": "results", "label": "i18n:automation.scale_rules.metric.results"},
                    {"value": "cost_per_result", "label": "i18n:automation.scale_rules.metric.cost_per_result"},
                    {"value": "spend", "label": "i18n:automation.scale_rules.metric.spend"},
                    {"value": "impressions", "label": "i18n:automation.scale_rules.metric.impressions"},
                    {"value": "frequency", "label": "i18n:automation.scale_rules.metric.frequency"}
                  ],
                  "validation": "required"
                },
                {
                  "name": "metric_level",
                  "label": "i18n:automation.scale_rules.field.metric_level",
                  "type": "select",
                  "required": true,
                  "options": [
                    {"value": "campaign", "label": "i18n:automation.scale_rules.level.campaign"},
                    {"value": "adset", "label": "i18n:automation.scale_rules.level.adset"},
                    {"value": "ad", "label": "i18n:automation.scale_rules.level.ad"}
                  ],
                  "validation": "required",
                  "help": "i18n:automation.scale_rules.field.metric_level_help"
                },
                {
                  "name": "time_range",
                  "label": "i18n:automation.scale_rules.field.time_range",
                  "type": "select",
                  "required": true,
                  "options": [
                    {"value": "last_3d", "label": "i18n:automation.scale_rules.time_range.last_3d"},
                    {"value": "last_7d", "label": "i18n:automation.scale_rules.time_range.last_7d"},
                    {"value": "last_14d", "label": "i18n:automation.scale_rules.time_range.last_14d"},
                    {"value": "last_30d", "label": "i18n:automation.scale_rules.time_range.last_30d"},
                    {"value": "lifetime", "label": "i18n:automation.scale_rules.time_range.lifetime"}
                  ],
                  "validation": "required"
                },
                {
                  "name": "operator",
                  "label": "i18n:automation.scale_rules.field.operator",
                  "type": "select",
                  "required": true,
                  "options": [
                    {"value": ">", "label": ">"},
                    {"value": "<", "label": "<"},
                    {"value": ">=", "label": "‚â•"},
                    {"value": "<=", "label": "‚â§"},
                    {"value": "==", "label": "="},
                    {"value": "is_within", "label": "i18n:automation.scale_rules.operator.is_within"}
                  ],
                  "validation": "required"
                },
                {
                  "name": "value",
                  "label": "i18n:automation.scale_rules.field.value",
                  "type": "number",
                  "required": true,
                  "placeholder": "0",
                  "step": 0.01,
                  "validation": "required"
                }
              ]
            },
            {
              "name": "value_suffix",
              "label": "i18n:automation.scale_rules.field.value_suffix",
              "type": "select",
              "options": [
                {"value": "", "label": "i18n:automation.scale_rules.suffix.none"},
                {"value": "percent", "label": "i18n:automation.scale_rules.suffix.percent"},
                {"value": "currency", "label": "$"}
              ],
              "condition": [
                {"field": "metric", "operator": "any", "value": "roas,cost_per_result,spend"}
              ],
              "conditionContext": "repeatable"
            }
          ]
        }
      ]
    }
  ],
  "statusbar": [
    {"name": "status", "type": "checkbox", "label": "i18n:automation.scale_rules.field.status", "default": true, "align": "left"},
    {"name": "cancel", "type": "button", "label": "i18n:core.cancel", "action": "call:ogModal.closeAll", "style": "secondary", "align": "right"},
    {"name": "submit", "type": "button", "label": "i18n:core.save", "action": "submit:scaleRule.save", "align": "right"}
  ]
}