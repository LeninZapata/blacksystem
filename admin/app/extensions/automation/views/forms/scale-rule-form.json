{
  "id": "scale-rule-form",
  "fields": [
    {
      "type": "group",
      "columns": 2,
      "gap": "normal",
      "fields": [
        {
          "name": "name",
          "label": "i18n:automation.scale_rules.field.name",
          "type": "text",
          "required": true,
          "placeholder": "i18n:automation.scale_rules.field.name_placeholder",
          "validation": "required|min:3|max:200"
        },
        {
          "name": "product_ad_asset_id",
          "label": "i18n:automation.scale_rules.field.product_ad_asset",
          "type": "select",
          "required": true,
          "source": "api/productAdAsset?per_page=1000&is_active=1",
          "sourceValue": "id",
          "sourceLabel": "ad_asset_name",
          "validation": "required",
          "help": "i18n:automation.scale_rules.field.product_ad_asset_help"
        }
      ]
    },
    {
      "name": "actions",
      "label": "i18n:automation.scale_rules.field.actions",
      "type": "repeatable",
      "addText": "i18n:automation.scale_rules.actions.add",
      "removeText": "i18n:core.delete",
      "hasHeader": true,
      "accordion": true,
      "headerTitle": "i18n:automation.scale_rules.actions.header {index}",
      "fields": [
        {
          "name": "action_type",
          "label": "i18n:automation.scale_rules.field.action_type",
          "type": "select",
          "required": true,
          "options": [
            {
              "value": "",
              "label": "i18n:core.form.select.placeholder"
            },
            {
              "value": "pause",
              "label": "i18n:automation.scale_rules.action_type.pause"
            },
            {
              "value": "increase_budget",
              "label": "i18n:automation.scale_rules.action_type.increase_budget"
            },
            {
              "value": "decrease_budget",
              "label": "i18n:automation.scale_rules.action_type.decrease_budget"
            },
            {
              "value": "disable_product",
              "label": "i18n:automation.scale_rules.action_type.disable_product"
            }
          ],
          "validation": "required"
        },
        {
          "name": "product_id",
          "label": "i18n:automation.scale_rules.field.product_to_disable",
          "type": "select",
          "required": true,
          "source": "api/product?status=1&per_page=1000",
          "sourceValue": "id",
          "sourceLabel": "name",
          "validation": "required",
          "help": "i18n:automation.scale_rules.field.product_to_disable_help",
          "condition": [
            {
              "field": "action_type",
              "operator": "equals",
              "value": "disable_product"
            }
          ],
          "conditionContext": "repeatable"
        },
        {
          "name": "budget_fields_group",
          "type": "group",
          "columns": 4,
          "gap": "normal",
          "condition": [
            {
              "field": "action_type",
              "operator": "any",
              "value": "increase_budget,decrease_budget"
            }
          ],
          "conditionContext": "repeatable",
          "fields": [
            {
              "name": "change_by",
              "label": "i18n:automation.scale_rules.field.change_by",
              "type": "number",
              "required": true,
              "placeholder": "20",
              "min": 0,
              "step": 1,
              "validation": "required|min:0"
            },
            {
              "name": "change_type",
              "label": "i18n:automation.scale_rules.field.change_type",
              "type": "select",
              "required": true,
              "options": [
                {
                  "value": "percent",
                  "label": "%"
                },
                {
                  "value": "fixed",
                  "label": "$"
                }
              ],
              "validation": "required"
            },
            {
              "name": "until_limit",
              "label": "i18n:automation.scale_rules.field.until_limit",
              "type": "number",
              "required": true,
              "placeholder": "500",
              "min": 0,
              "step": 0.01,
              "validation": "required|min:0",
              "help": "i18n:automation.scale_rules.field.until_limit_help"
            },
            {
              "name": "until_currency",
              "label": "i18n:automation.scale_rules.field.currency",
              "type": "select",
              "required": true,
              "options": [
                {
                  "value": "USD",
                  "label": "$"
                }
              ],
              "defaultValue": "USD"
            }
          ]
        },
        {
          "name": "period_fields_group",
          "type": "group",
          "columns": 2,
          "gap": "normal",
          "condition": [
            {
              "field": "action_type",
              "operator": "any",
              "value": "increase_budget,decrease_budget"
            }
          ],
          "conditionContext": "repeatable",
          "fields": [
            {
              "name": "time_period",
              "label": "i18n:automation.scale_rules.field.time_period",
              "type": "select",
              "required": true,
              "options": [
                {
                  "value": "everytime",
                  "label": "i18n:automation.scale_rules.time_period.everytime"
                },
                {
                  "value": "once",
                  "label": "i18n:automation.scale_rules.time_period.once"
                },
                {
                  "value": "daily",
                  "label": "i18n:automation.scale_rules.time_period.daily"
                }
              ],
              "validation": "required",
              "help": "i18n:automation.scale_rules.field.time_period_help"
            },
            {
              "name": "budget_type",
              "label": "i18n:automation.scale_rules.field.budget_type",
              "type": "select",
              "required": true,
              "options": [
                {
                  "value": "daily",
                  "label": "i18n:automation.scale_rules.budget_type.daily"
                },
                {
                  "value": "lifetime",
                  "label": "i18n:automation.scale_rules.budget_type.lifetime"
                }
              ],
              "validation": "required"
            }
          ]
        }
      ],
      "accordionOpenFirst": true,
      "sortable": true,
      "initialItems": 1
    },
    {
      "type": "html",
      "content": "<div style='background: #f0fdf4; padding: 1rem; border-radius: 6px; margin: 2rem 0 1rem; border-left: 4px solid #10b981;'><strong>ðŸŽ¯ Condiciones</strong><p style='margin: 0.5rem 0 0; font-size: 0.9rem;'>Define las condiciones que deben cumplirse para que se ejecuten las acciones. Las condiciones se evalÃºan segÃºn la lÃ³gica seleccionada.</p></div>"
    },
    {
      "type": "html",
      "content": "<div class='view-toolbar' style='display: flex; justify-content: flex-end; margin-bottom: 1rem;'><select id='conditions_logic' name='conditions_logic' class='form-control' style='width: auto;'><option value='and_or_and'>(AND) or (AND)</option><option value='or_and_or'>(OR) and (OR)</option></select></div>"
    },
    {
      "name": "condition_groups",
      "label": "i18n:automation.scale_rules.field.condition_groups",
      "type": "repeatable",
      "addText": "i18n:automation.scale_rules.conditions.add_group",
      "hasHeader": false,
      "accordion": true,
      "sortable": true,
      "accordionOpenFirst": true,
      "accordionOpenAll": true,
      "initialItems": 1,
      "removeText": "âŒ",
      "headerTitle": "i18n:automation.scale_rules.conditions.group_header {index}",
      "fields": [
        {
          "name": "conditions",
          "label": "i18n:automation.scale_rules.field.conditions",
          "type": "repeatable",
          "addText": "i18n:automation.scale_rules.conditions.add",
          "accordionOpenAll": true,
          "initialItems": 1,
          "accordionOpenFirst": true,
          "removeText": "âŒ",
          "sortable": true,
          "fields": [
            {
              "type": "group",
              "columns": 4,
              "gap": "small",
              "fields": [
                {
                  "name": "metric",
                  "label": "i18n:automation.scale_rules.field.metric",
                  "type": "select",
                  "required": true,
                  "options": [
                    {
                      "value": "",
                      "label": "i18n:core.form.select.placeholder"
                    },
                    {
                      "value": "roas",
                      "label": "i18n:automation.scale_rules.metric.roas"
                    },
                    {
                      "value": "results",
                      "label": "i18n:automation.scale_rules.metric.results"
                    },
                    {
                      "value": "cost_per_result",
                      "label": "i18n:automation.scale_rules.metric.cost_per_result"
                    },
                    {
                      "value": "spend",
                      "label": "i18n:automation.scale_rules.metric.spend"
                    },
                    {
                      "value": "impressions",
                      "label": "i18n:automation.scale_rules.metric.impressions"
                    },
                    {
                      "value": "frequency",
                      "label": "i18n:automation.scale_rules.metric.frequency"
                    }
                  ],
                  "validation": "required"
                },
                {
                  "name": "time_range",
                  "label": "i18n:automation.scale_rules.field.time_range",
                  "type": "select",
                  "required": true,
                  "options": [
                    {
                      "value": "today",
                      "label": "i18n:automation.scale_rules.time_range.today"
                    },
                    {
                      "value": "yesterday",
                      "label": "i18n:automation.scale_rules.time_range.yesterday"
                    },
                    {
                      "value": "last_3d",
                      "label": "i18n:automation.scale_rules.time_range.last_3d"
                    },
                    {
                      "value": "last_7d",
                      "label": "i18n:automation.scale_rules.time_range.last_7d"
                    },
                    {
                      "value": "last_14d",
                      "label": "i18n:automation.scale_rules.time_range.last_14d"
                    },
                    {
                      "value": "last_30d",
                      "label": "i18n:automation.scale_rules.time_range.last_30d"
                    },
                    {
                      "value": "lifetime",
                      "label": "i18n:automation.scale_rules.time_range.lifetime"
                    }
                  ],
                  "validation": "required"
                },
                {
                  "name": "operator",
                  "label": "i18n:automation.scale_rules.field.operator",
                  "type": "select",
                  "required": true,
                  "options": [
                    {
                      "value": ">",
                      "label": ">"
                    },
                    {
                      "value": "<",
                      "label": "<"
                    },
                    {
                      "value": ">=",
                      "label": "â‰¥"
                    },
                    {
                      "value": "<=",
                      "label": "â‰¤"
                    },
                    {
                      "value": "==",
                      "label": "="
                    },
                    {
                      "value": "is_within",
                      "label": "i18n:automation.scale_rules.operator.is_within"
                    }
                  ],
                  "validation": "required"
                },
                {
                  "name": "value",
                  "label": "i18n:automation.scale_rules.field.value",
                  "type": "number",
                  "required": true,
                  "placeholder": "0",
                  "step": 0.01,
                  "validation": "required"
                }
              ]
            },
            {
              "name": "value_suffix",
              "label": "i18n:automation.scale_rules.field.value_suffix",
              "type": "select",
              "options": [
                {
                  "value": "",
                  "label": "i18n:automation.scale_rules.suffix.none"
                },
                {
                  "value": "percent",
                  "label": "i18n:automation.scale_rules.suffix.percent"
                },
                {
                  "value": "currency",
                  "label": "$"
                }
              ],
              "condition": [
                {
                  "field": "metric",
                  "operator": "any",
                  "value": "roas,cost_per_result,spend"
                }
              ],
              "conditionContext": "repeatable"
            }
          ]
        }
      ]
    }
  ],
  "statusbar": [
    {
      "name": "is_active",
      "type": "checkbox",
      "label": "i18n:automation.scale_rules.field.is_active",
      "default": true,
      "align": "left"
    },
    {
      "name": "cancel",
      "type": "button",
      "label": "i18n:core.cancel",
      "action": "call:ogModal.closeAll",
      "style": "secondary",
      "align": "right"
    },
    {
      "name": "submit",
      "type": "button",
      "label": "i18n:core.save",
      "action": "submit:scaleRule.save",
      "align": "right"
    }
  ]
}